"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[494],{96991:function(N,T,e){e.d(T,{V:function(){return L}});var M=e(90228),s=e.n(M),O=e(87999),m=e.n(O),o=e(48305),g=e.n(o),c=e(26068),f=e.n(c),d=e(50959),y=e(60556);function C(u){var a={},i=[];return u.forEach(function(n){a[n.id]=f()(f()({},n),{},{children:[]})}),u.forEach(function(n){var v=n.parent?a[n.parent.id]:null;v?v.children.push({value:n.id,title:n.name,children:a[n.id].children}):i.push({value:a[n.id].id,title:a[n.id].name,children:a[n.id].children})}),i}function L(){var u=(0,d.useState)([]),a=g()(u,2),i=a[0],n=a[1],v=function(){var t=m()(s()().mark(function h(){var E;return s()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,y.vO)();case 2:E=p.sent,n(C(E.data.list));case 4:case"end":return p.stop()}},h)}));return function(){return t.apply(this,arguments)}}();return{loadDataDepartmentsAPI:v,allDepartmentsData:i}}},41746:function(N,T,e){e.d(T,{R:function(){return v},d:function(){return n}});var M=e(90228),s=e.n(M),O=e(87999),m=e.n(O),o=e(48305),g=e.n(o),c=e(50959),f=e(11805);function d(t){return y.apply(this,arguments)}function y(){return y=m()(s()().mark(function t(h){var E;return s()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,f.request)("/api/v1/roles",{method:"GET",params:{page:h.current,per:h.pageSize}});case 2:return E=p.sent,p.abrupt("return",{data:E.data.list,success:!0,total:E.data.total});case 4:case"end":return p.stop()}},t)})),y.apply(this,arguments)}function C(t){return request("/api/v1/roles",{method:"POST",data:t})}function L(t,h){return request("/api/v1/roles/"+t,{method:"PATCH",data:h})}function u(t){return request("/api/v1/roles/"+t,{method:"DELETE"})}function a(t){return request("/api/v1/roles/remove_many",{method:"DELETE",params:{ids:t}})}var i=e(23306);function n(){var t=(0,c.useState)([]),h=g()(t,2),E=h[0],j=h[1],p=function(){var W=m()(s()().mark(function x(){var B;return s()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.next=2,d({pageSize:100});case 2:B=D.sent,j(B.data.map(function(Z){return{value:Z.id,label:Z.name}}));case 4:case"end":return D.stop()}},x)}));return function(){return W.apply(this,arguments)}}();return(0,c.useEffect)(function(){p()},[]),{roles:E}}function v(){var t=(0,c.useState)([]),h=g()(t,2),E=h[0],j=h[1],p=function(){var W=m()(s()().mark(function x(){var B;return s()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.next=2,(0,i.LL)();case 2:B=D.sent,j(B.data.map(function(Z){return{value:Z.id,label:Z.realName}}));case 4:case"end":return D.stop()}},x)}));return function(){return W.apply(this,arguments)}}();return(0,c.useEffect)(function(){p()},[]),{leaveCheckers:E}}},49363:function(N,T,e){e.r(T),e.d(T,{default:function(){return de}});var M=e(26068),s=e.n(M),O=e(90228),m=e.n(O),o=e(87999),g=e.n(o),c=e(48305),f=e.n(c),d=e(50959),y=e(54885),C=e(77097),L=e(56249),u=e(25283),a=e(1536),i=e(21720),n=e(24706),v=e(56395),t=e(19991),h=e(14292),E=e(53739),j=e(55641),p=e(68380),W=e(23777),x=e(83011),B=e(1442),K=e(23306),D=e(62698),Z=e(69012),ne=e(66838),r=e(11527),De=function(I,A){var P=new FileReader;P.addEventListener("load",function(){return A(P.result)}),P.readAsDataURL(I)},Ee=function(I){var A=I.type==="image/jpeg"||I.type==="image/png";A||message.error("You can only upload JPG/PNG file!");var P=I.size/1024/1024<2;return P||message.error("Image must smaller than 2MB!"),A&&P},te=function(I){var A=I.imageUrl,P=I.setImageUrl,Y=(0,d.useState)(!1),$=f()(Y,2),z=$[0],F=$[1],Q=function(G){if(G.file.status==="uploading"){F(!0);return}G.file.status==="done"&&(P(G.file.response.data),F(!1))},H=(0,r.jsxs)("div",{children:[z?(0,r.jsx)(Z.Z,{}):(0,r.jsx)(B.Z,{}),(0,r.jsx)("div",{style:{marginTop:8},children:"Upload"})]});return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(ne.Z,{name:"file",listType:"picture-card",className:"avatar-uploader",showUploadList:!1,action:D.P_,onChange:Q,children:A?(0,r.jsx)("img",{src:(0,D.w0)(A),alt:"avatar",style:{width:"100%"}}):H})})},se=te,ue=e(41746),le=e(96991);function oe(){var w=(0,d.useState)(!1),I=f()(w,2),A=I[0],P=I[1],Y=(0,d.useState)(""),$=f()(Y,2),z=$[0],F=$[1],Q=(0,d.useState)(""),H=f()(Q,2),X=H[0],G=H[1],ie=(0,d.useState)([]),q=f()(ie,2),ee=q[0],ae=q[1],V=(0,d.useRef)(),pe=y.A.useForm(),me=f()(pe,1),k=me[0],_e=(0,ue.d)(),ce=_e.roles,re=(0,le.V)(),ve=re.allDepartmentsData,fe=re.loadDataDepartmentsAPI;(0,d.useEffect)(function(){fe()},[]);var he=[{title:"\u5E8F\u53F7",hideInSearch:!0,render:function(_,l,R){return R+1}},{title:"\u7528\u6237\u540D",hideInSearch:!0,dataIndex:"userName"},{title:"\u540D\u5B57",dataIndex:"realName",fieldProps:{name:"name"}},{title:"\u6635\u79F0",hideInSearch:!0,dataIndex:"nickName"},{title:"\u5934\u50CF",hideInSearch:!0,align:"center",render:function(_){return(0,r.jsx)(t.Z,{src:(0,D.w0)(_.avatar),width:120})}},{title:"\u89D2\u8272",hideInSearch:!0,render:function(_){var l;return(l=_.role)===null||l===void 0?void 0:l.name}},{title:"\u90E8\u95E8",hideInSearch:!0,render:function(_){var l;return _.department?((l=_.department)===null||l===void 0?void 0:l.name)+(_.isManager?"\u3010\u4E3B\u7BA1\u3011":""):""}},{title:"\u64CD\u4F5C",hideInSearch:!0,render:function(_,l){return(0,r.jsxs)(h.Z,{children:[(0,r.jsx)(E.Z,{title:"\u662F\u5426\u786E\u8BA4\u5220\u9664?",onConfirm:g()(m()().mark(function R(){var S;return m()().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:return J.next=2,(0,K.aR)(l.id);case 2:(S=V.current)===null||S===void 0||S.reload();case 3:case"end":return J.stop()}},R)})),children:(0,r.jsx)(j.ZP,{type:"primary",danger:!0,size:"small",icon:(0,r.jsx)(W.Z,{})})}),(0,r.jsx)(j.ZP,{type:"primary",size:"small",icon:(0,r.jsx)(x.Z,{}),onClick:function(){F(l.avatar),k.setFieldsValue(l),G(l.id),P(!0)}})]})}}];return(0,d.useEffect)(function(){A||(k.resetFields(),F(""),G(""),ae([]))},[A]),(0,r.jsxs)(C._z,{children:[(0,r.jsx)(L.Z,{bordered:!0,size:"small",columns:he,request:K.kD,actionRef:V,tableAlertRender:!1,toolBarRender:function(){return[(0,r.jsx)(j.ZP,{icon:(0,r.jsx)(B.Z,{}),onClick:function(){return P(!0)}},1),(0,r.jsx)(E.Z,{title:"\u662F\u5426\u786E\u8BA4\u5220\u9664?",onConfirm:g()(m()().mark(function _(){var l;return m()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,(0,K.Ln)(ee.join(","));case 2:(l=V.current)===null||l===void 0||l.reload();case 3:case"end":return S.stop()}},_)})),children:(0,r.jsx)(j.ZP,{type:"primary",danger:!0,style:{display:ee.length>0?"":"none"},children:"\u6279\u91CF\u5220\u9664"})},2)]},rowKey:"id",rowSelection:{onChange:function(_){ae(_)}}}),(0,r.jsxs)(u.Y,{form:k,open:A,onOpenChange:P,title:"\u7F16\u8F91",onFinish:function(){var b=g()(m()().mark(function _(l){var R;return m()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(!X){U.next=5;break}return U.next=3,(0,K.G_)(X,s()(s()({},l),{},{avatar:z}));case 3:U.next=7;break;case 5:return U.next=7,(0,K.EA)(s()(s()({},l),{},{avatar:z}));case 7:P(!1),(R=V.current)===null||R===void 0||R.reload();case 9:case"end":return U.stop()}},_)}));return function(_){return b.apply(this,arguments)}}(),children:[(0,r.jsx)(a.Z,{label:"\u7528\u6237\u540D",name:"userName",rules:[{required:!0,message:"\u7528\u6237\u540D\u4E0D\u80FD\u4E3A\u7A7A"}]}),(0,r.jsx)(i.Z,{label:"\u5934\u50CF",children:(0,r.jsx)(se,{imageUrl:z,setImageUrl:F})}),(0,r.jsx)(a.Z,{label:"\u5BC6\u7801",name:"password",rules:[{required:!0,message:"\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A"}]}),(0,r.jsx)(a.Z,{label:"\u6635\u79F0",name:"nickName",rules:[]}),(0,r.jsx)(a.Z,{label:"\u540D\u5B57",name:"realName",rules:[{required:!0,message:"\u540D\u5B57\u4E0D\u80FD\u4E3A\u7A7A"}]}),(0,r.jsx)(n.Z,{label:"\u89D2\u8272",options:ce,name:"roleId"}),(0,r.jsx)(v.Z.Group,{options:[{value:!0,label:"\u662F"},{value:!1,label:"\u5426"}],label:"\u662F\u5426\u90E8\u95E8\u4E3B\u7BA1",name:"isManager"}),(0,r.jsx)(y.A.Item,{label:"\u90E8\u95E8",name:"departmentId",rules:[{required:!0,message:"\u90E8\u95E8\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,r.jsx)(p.Z,{showSearch:!0,style:{width:"100%"},dropdownStyle:{maxHeight:400,overflow:"auto"},placeholder:"Please select",allowClear:!0,treeDefaultExpandAll:!0,treeData:ve})})]})]})}var de=oe},60556:function(N,T,e){e.d(T,{EA:function(){return y},G_:function(){return C},Ln:function(){return u},aR:function(){return L},kD:function(){return g},vO:function(){return f}});var M=e(90228),s=e.n(M),O=e(87999),m=e.n(O),o=e(11805);function g(a){return c.apply(this,arguments)}function c(){return c=m()(s()().mark(function a(i){var n;return s()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,o.request)("/api/v1/departments",{method:"GET",params:{page:i.current,per:i.pageSize}});case 2:return n=t.sent,t.abrupt("return",{data:n.data.list,success:!0,total:n.data.total});case 4:case"end":return t.stop()}},a)})),c.apply(this,arguments)}function f(){return d.apply(this,arguments)}function d(){return d=m()(s()().mark(function a(){return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,o.request)("/api/v1/departments",{method:"GET",params:{per:100}}));case 1:case"end":return n.stop()}},a)})),d.apply(this,arguments)}function y(a){return(0,o.request)("/api/v1/departments",{method:"POST",data:a})}function C(a,i){return(0,o.request)("/api/v1/departments/"+a,{method:"PATCH",data:i})}function L(a){return(0,o.request)("/api/v1/departments/"+a,{method:"DELETE"})}function u(a){return(0,o.request)("/api/v1/departments/remove_many",{method:"DELETE",params:{ids:a}})}},23306:function(N,T,e){e.d(T,{EA:function(){return f},G_:function(){return y},LL:function(){return d},Ln:function(){return L},aR:function(){return C},kD:function(){return g}});var M=e(90228),s=e.n(M),O=e(87999),m=e.n(O),o=e(11805);function g(u){return c.apply(this,arguments)}function c(){return c=m()(s()().mark(function u(a){var i;return s()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,(0,o.request)("/api/v1/employees",{method:"GET",params:{page:a.current,per:a.pageSize}});case 2:return i=v.sent,v.abrupt("return",{data:i.data.list,success:!0,total:i.data.total});case 4:case"end":return v.stop()}},u)})),c.apply(this,arguments)}function f(u){return(0,o.request)("/api/v1/employees",{method:"POST",data:u})}function d(){return(0,o.request)("/api/v1/employees/user/leave_checkers",{method:"GET"})}function y(u,a){return(0,o.request)("/api/v1/employees/"+u,{method:"PATCH",data:a})}function C(u){return(0,o.request)("/api/v1/employees/"+u,{method:"DELETE"})}function L(u){return(0,o.request)("/api/v1/employees/remove_many",{method:"DELETE",params:{ids:u}})}}}]);
